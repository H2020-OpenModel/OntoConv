---

version: 1

# Documentation of existing data sources and sinks that will be placed in the
# knowledge base.
data_resources:

  # Load aluminium material card
  http://openmodel.eu/ss3/aluminium_material_card:
    - dataresource:
        downloadUrl: file://tests/tests_dlite_plugins/testfiles/input/material_card_al.json
        mediaType: application/vnd.dlite-parse
        configuration:
          label: materialcard_al
          metadata: http://www.sintef.no/calm/0.1/AbaqusSimpleMaterialCard"
          driver: "json"


  # Create the material card input file for Abaqus
  http://openmodel.eu/ss3/create_abaqus_input_material_card:
    - function:
        functionType: application/vnd.dlite-generate
        configuration:
          driver: plugin_abaqus_material
          # the name of the file is as expected by the Abaqus input template
          location: Section_materials.inp
          # the option indicates that we want to write a new file and the header
          options: "mode=w"
          label: materialcard_al


  # Load material for concrete
  http://openmodel.eu/ss3/concrete_material_card:
    - dataresource:
       configuration:
         label: materialcard_concrete
         metadata: http://www.sintef.no/calm/0.1/AbaqusSimpleMaterialCard"
         driver: "json"
       downloadUrl: file://tests/tests_dlite_plugins/testfiles/input/material_card_concrete.json
       mediaType: application/vnd.dlite-parse


  # Append to material card input file for Abaqus
  http://openmodel.eu/ss3/append_abaqus_input_material_card:
    - function:
       functionType: application/vnd.dlite-generate
       configuration:
         driver: plugin_abaqus_material
         # the name of the file is as expected by the Abaqus input template
         location: Section_materials.inp
         # the option indicates that we do not write the header
         options: "mode=a"
         label: materialcard_concrete


  # Create the AiiDA SingleFile nodes in two steps through a Dlite collection
  # Step1 file stored in a dlite collection
  http://openmodel.eu/ss3/file2collection_mat:
    - function:
       functionType: aiidacuds/file2collection
       configuration:
         path: Section_materials.inp
         label: material_file


  # Step 2 convert the file to an AiiDA node
  # specific to execution with execflow
  # the variable names defined in the declarative workflow should correspond to the label "material_file"
  # from_cuds is not really a label you can't change it is a hard-coded thing
  http://openmodel.eu/ss3/cuds2datanode:
    - function:
       functionType: aiidacuds/cuds2datanode
       configuration:
         names: from_cuds
